<!DOCTYPE html>
<html>
<head>
    <title>Clients</title>
    <script src="https://www.gstatic.com/firebasejs/8.6.7/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.6.7/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.6.7/firebase-database.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.6.7/firebase-storage.js"></script>
<link rel="stylesheet" href="style.css">
<link rel="stylesheet" href="clients.css">
<!-- <link rel="stylesheet" href="dashboard.css"> -->
<link href='https://unpkg.com/boxicons@2.0.7/css/boxicons.min.css' rel='stylesheet'>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-+0n0xVW2eSR5OomGNYDnhzAbDsOXxcvSN1TPprVMTNDbiYZCxYbOOl7+AMvyTG2x" crossorigin="anonymous">
<link rel="stylesheet" href="https://maxst.icons8.com/vue-static/landings/
        line-awesome/line-awesome/1.3.0/css/line-awesome.min.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.11.2/css/all.css">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-gtEjrD/SeCtmISkJkNUaaKMoLD0//ElJ19smozuHV6z3Iehds+3Ulb9Bn9Plx0x4" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js" integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.min.js" integrity="sha384-Atwg2Pkwv9vp0ygtn1JAojH0nYbwNJLPhwyoVbhoPwBhjQPR5VtM2+xf0Uwh9KtT" crossorigin="anonymous"></script>

</head>


<body>
    
    
    <div id="openModal" class="modalbg">
    <div class="dialog">
        <a href="#close" title="Close" class="close">X</a>
        <div class="modal-text">
            <div id="test">
                       <h2>Add New Client</h2>
                        <!-- <p>Enter client's details on the fields below to add to the database</p> -->
                        <form id="addCli" action="">
                            <p><b>Email</b></p>
                            <input type="style-text" placeholder="Email adress" id="email" required>
                            <p><b>Full Name</b></p>
                            <input type="style-text" placeholder="Full Name" id="fullName" required>
                            <p><b>D.O.C</b></p>
                            <input type="style-text" placeholder="Date of contract" id="dob" required>
                            <p><b>Phone number</b></p>
                            <input type="style-text" placeholder="Phone Number" id="pN" required>
                            <p><b>Dependence</b></p>
                            <input type="style-text" placeholder="Dependence" id="dependence" required>
                            <p><b>Residence</b></p>
                            <input type="style-text" placeholder="Residence" id="residence" required>
                            <p><b>ID No.</b></p>
                            <input type="style-text" placeholder="ID Number" id="idNo" required>
                            <p><b>Payment method</b></p>
                            <select class="InterestsField" id = "pM" required>
                            <option value = "">--Select--</option>
                            <option value = "Cash">Cash</option>
                            <option value = "M-pesa">M-pesa</option>
                            <option value = "Cheque">Cheque</option>
                            <option value = "Bank transfer">Bank transfer</option>

                            </select>
                            <!-- <input type="style-text" placeholder="Interest" id="interest" required> -->
                            <p><b>Ivoice Date</b></p>
                            <input type="style-text" placeholder="Invoice Date" id="date" required>
                            <input onclick="submit()" class="submit" type="submit" value="ADD">
                            
                        </form>
            </div>
            
        </div>
    </div>
    </div>

    <input type="checkbox" id="nav-toggle">
        <div class="sidebar Dtable-responsive">
            <div class="sidebar-brand">
                
                <h2><img class="logo" src="images (1).png" width="30px" height="30px" alt="">
                    <span class="lab la-accusoft"><span>GreenHaven</span></span></h2>
            </div>
            <div class="sidebar-menu">
                <ul>
                    <li>
                        <a href="dashboard.html"><span class="bx bxs-grid"></span>
                            <span>Dashboard</span></a>
                    </li>
                    <li>
                        <a href="clients.html" class="active"><span class="bx bxs-group"></span>
                            <span>Clients</span></a>
                    </li>
                    <li>
                        <a href="projects.html"><span class="bx bxl-product-hunt"></span>
                            <span>Projects</span></a>
                    </li>
                    <li>
                        <a href="employees.html"><span class="bx bx-money"></span>
                            <span>Employees</span></a>
                    </li>
                    <li>
                        <a href="#"><span class="bx bx-task"></span>
                            <span>Tasks</span></a>
                    </li>
                    <li>
                        <a href="#"><span class="bx bx-landscape"></span>
                            <span>Plots</span></a>
                    </li>
                    <li>
                        <a href="#"><span class="bx bx-calendar-event"></span>
                            <span>Events</span></a>
                    </li>
                    <li class="gallery">
                        <a href=""><span class="bx bx-category"></span>
                            <span>Gallery</span></a>
                            <div class="subs">
                                <!-- <ul>
                                <li><a href="videos.html">Videos</a></li>
                                
                                </ul> -->
                                <ul>
                                    <li><a href="pictures.html">Pictures</a></li>
                                </ul>
                            </div>
                            
                    </li>
                    <li>
                        <a href=""><span class="bx bx-collection"></span>
                            <span>Assets</span></a>
                    </li>
                    <li>
                        <a href=""><span class="bx bx-receipt"></span>
                            <span>Guest Book</span></a>
                    </li>
                    
                    
                </ul>
            </div>
        </div>
        <div class="main-content">
            <header>
                <h3>
                    <label for="nav-toggle">
                        <span class="bx bxs-grid"></span>
                    </label>
                    Clients
                </h3>
               
                
            </header>
            <main>
                <div class="client-container" id="single-container">
                    <div class="jumbotron">
            
                        <div class="client-card">
                            <div class="card-header">
                              Client's Details
                              <div class="-wrapper">
                                <a href="clients.html"><button onclick="back()" class="back" type="back">Back</button></a>
                                
                                
                            </div>
                             
                            </div>
                            
                            <div class="clients-card-body">
                                <div class="list" >
                                    <div class="cidiv">
                                        <img class="ClientImage" src="images (1).png" width="70px" height="70px" alt="">
                                        <ul id="lists"></ul>
                                    </div>
                                    <!-- <h4 class="fullname" id="fullNameField"> Full Name: Samson Omondi</h4> -->
                                   
                                        
                                </div>
                                    
                            
                                 <!-- <div class="table-wrapper-scroll-y my-custom-scrollbar">
                               
                            
                                </div> -->
                              <!-- <p class="card-text">With supporting text below as a natural lead-in to additional content.</p>
                              <a href="#" class="btn btn-primary">Go somewhere</a> -->
                            </div>
                          </div>
                    </div>
                </div>
                <div>
                    <div class="container" id="clientsContainer">
                        <div class="jumbotron">
                
                            <div class="card">
                                <div class="card-header">
                                  Clients
                                  <div class="search-wrapper">
                                    <span class="bx bx-search"></span>
                                    <input type="search" placeholder="Search Clients" id="search">
                                    <button onclick="fetchData()" class="getClientsDetails" type="getClientsDetails">Get</button>
                                    
                                </div>
                                </div>
                                
                                <div class="card-body">
                                  <h5 class="card-title">All Clients</h5>
                
                                  <a href="dashboard.html"> <button  class="btn btn-primary badge-pill" style="height:30px ">Back</button></a>
                                  <a href="#openModal" class="button"><button class="btn btn-warning"  style="height:30px ">Add New</button></a>
                                  
    
                                     <div class="table-wrapper-scroll-y my-custom-scrollbar">
                                    <table class="table table-hover table-bordered table-striped " id="table">
                                            <thead>
                                                <th>No</th>
                                                <th>Name</th>
                                                <th>Email Adress</th>
                                                <th>D.O.C</th> 
                                                <th>Phone No</th>
                                                <th>Dependence</th>
                                                <th>Residence</th>
                                                <th>Payment...Method</th>
                                                <th>ID No</th>
                                                <th>Invoice...Date</th>
                                                <th>Assigned ID</th>
                                                
                                                <!-- <th>ACTION</th>  -->
                                            </thead>
                                            <tbody id = "tbody1">
                                            
                                            </tbody>
                                        </table>
                                
                                    </div>
                                  <!-- <p class="card-text">With supporting text below as a natural lead-in to additional content.</p>
                                  <a href="#" class="btn btn-primary">Go somewhere</a> -->
                                </div>
                              </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>


    
    
   
   

   
    <script id = "MainScript">

 
    var firebaseConfig = {
        apiKey: "AIzaSyBEWOVJ5VBhb-oIf5-Y3SNiqeJwvO-rgus",
        authDomain: "greenhaven-835b8.firebaseapp.com",
        databaseURL: "https://greenhaven-835b8-default-rtdb.firebaseio.com",
        projectId: "greenhaven-835b8",
        storageBucket: "greenhaven-835b8.appspot.com",
        messagingSenderId: "957724070580",
        appId: "1:957724070580:web:643352cfc7858ad1353de1",
        measurementId: "G-5M36VH3YEL"
    };
    // Initialize Firebase
    //firebase.initializeApp(firebaseConfig);

// ----------GET ALL DATA--------//

    function SellectAllData(){
        firebase.database().ref("Clients").once("value",
        function(AllRecords){
            AllRecords.forEach(
                function(CurrentRecord){ 
                    var email = CurrentRecord.val().email; 
                    var fullname = CurrentRecord.val().fullname;
                    var pN = CurrentRecord.val().phoneNumber;
                    var dob = CurrentRecord.val().dob;
                    var dependence = CurrentRecord.val().dependence;
                    var residence = CurrentRecord.val().residence;
                    var payM = CurrentRecord.val().pM;
                    var tiitleDeedNo = CurrentRecord.val().tiitleDeedNo;
                    var admisionDate = CurrentRecord.val().admisionDate;
                    var id = CurrentRecord.val().id;

                    AddItemsToTable(email,fullname,dob,pN,dependence,residence,payM,tiitleDeedNo,admisionDate,id);
                    // firebase.database().ref('Clients').orderByChild('email').equalTo(email).once( 'value', data => {
                    // let user = data.val();
                    // console.log(user);
                    // });

                }
            )
        })

    }

    window.onload = SellectAllData;

// -----------FILLING THE DATA---------
  var ClientNo = 0;
    function AddItemsToTable(email,fullname,dob,pN,dependence,residence,pM,tiitleDeedNo,admisionDate,id){
        var tbody = document.getElementById("tbody1");
        var trow = document.createElement("tr");
        var td1 = document.createElement("td");
        var td2 = document.createElement("td");
        var td3 = document.createElement("td");
        var td4 = document.createElement("td");
        var td5 = document.createElement("td");
        var td6 = document.createElement("td");
        var td7 = document.createElement("td");
        var td8 = document.createElement("td");
        var td9 = document.createElement("td");
        var td10 = document.createElement("td");
        var td11 = document.createElement("td");
        
        {
            td1.style.fontWeight ="bold";
        }

        td1.innerHTML = ++ClientNo;
        td2.innerHTML = fullname;
        td3.innerHTML = email;
        td4.innerHTML = dob;
        td5.innerHTML = pN;
        td6.innerHTML = dependence;
        td7.innerHTML = residence;
        td8.innerHTML = pM;
        td9.innerHTML = tiitleDeedNo;
        td10.innerHTML = admisionDate;
        td11.innerHTML = id;
        trow.appendChild(td1); 
        trow.appendChild(td2);
        trow.appendChild(td3);
        trow.appendChild(td4);
        trow.appendChild(td5);
        trow.appendChild(td6);
        trow.appendChild(td7);
        trow.appendChild(td8);
        trow.appendChild(td9);
        trow.appendChild(td10);
        trow.appendChild(td11);
        tbody.appendChild(trow);


    }

    //var clientID = 0;
    function addItemsToList(email,fullname,dob,phoneNumber,dependence,residence,pM,tiitleDeedNo,admisionDate,id){
        var testDiv = document.createElement('div');
        var ul = document.getElementById("lists");
        //var header = document.createElement("h3");

       // var header = document.createElement("li");
        var fllname = document.createElement("h4");
        var mail = document.createElement("li");
        var Dob = document.createElement("li");
        var pn = document.createElement("li");
        var Dependence = document.createElement("li");
        var Residence = document.createElement("li");
        var payM = document.createElement("li");
        var TiitleDeedNo = document.createElement("li");
        var AdmisionDate = document.createElement("li");
        var Id = document.createElement("li");

       // header.innerHTML = (++clientID);
        fllname.innerHTML =("Full Name: ") +fullname;
        mail.innerHTML =("Email Adress: ") +email;
        Dob.innerHTML =("Date of Birth: ") +dob;
        pn.innerHTML =("Phone Number: ") +phoneNumber;
        Dependence.innerHTML =("Dependece: ") +dependence;
        Residence.innerHTML =("Residence: ") +residence;
        payM.innerHTML =("Payment Method: ") +pM;
        TiitleDeedNo.innerHTML =("ID No: ") +tiitleDeedNo;
        AdmisionDate.innerHTML =("Joined us on: ") +admisionDate;
        Id.innerHTML =("System ID: ") +id;

        //ul.appendChild(header);
        ul.appendChild(fllname);
        ul.appendChild(mail);
        ul.appendChild(Dob);
        ul.appendChild(pn);
        ul.appendChild(Dependence);
        ul.appendChild(Residence);
        ul.appendChild(payM);
        ul.appendChild(TiitleDeedNo);
        ul.appendChild(AdmisionDate);
        ul.appendChild(Id);
        //testDiv.appendChild(ul);
        //window.onload(fetchData());

        var cont = document.getElementById("clientsContainer");
        var singleCont = document.getElementById("single-container");

        singleCont.style.display = "block";
        cont.style.display = "none";
        
        
    }
    // function back(){
    //     var cont = document.getElementById("clientsContainer");
    //     var singleCont = document.getElementById("single-container");

    //     singleCont.style.display = "none";
    //     cont.style.display = "block";
    // }
    
    function fetchData(){

        //nameField.appendChild(clientName);
        var id = getInputValue("search");
        var cont = document.getElementById("clientsContainer");
        // window.alert(id);
        // firebase.initializeApp(firebaseConfig);
        firebase.database().ref("Clients/" +id).once('value',
        function(snapshot){
           
                    let fullname = snapshot.val().fullname;
                    let email = snapshot.val().email;
                    let dob = snapshot.val().dob;
                    let pn = snapshot.val().phoneNumber;
                    let dependence = snapshot.val().dependence;
                    let residence = snapshot.val().residence;
                    let payM = snapshot.val().pM;
                    let tiitleDeedNo = snapshot.val().tiitleDeedNo;
                    let admisionDate = snapshot.val().admisionDate;
                    let id = snapshot.val().id;
                    //getClientsDetails(fullname);
                    //console.log(name);
                    addItemsToList(email,fullname,dob,pn,dependence,residence,payM,tiitleDeedNo,admisionDate,id);
                    //togleContainers();
            }
            
        );
    }

    function togleContainers(){
        var clientsContainer = document.getElementById("container");
        var dispaySetting = clientsContainer.style.display;

        if(dispaySetting === "block"){
            clientsContainer.style.display = "none";
        }

        
    }

    
    //window.onload( .style.display = "none");
    //fetchData(fullname);


    </script>
  
<script src="submit.js"></script>

</body>

</html>